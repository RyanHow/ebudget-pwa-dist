webpackJsonp([6],{469:function(t,a,n){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),n.d(a,"TransactionWizardModuleNgFactory",function(){return I});var i=n(0),o=n(473),s=n(390),e=n(391),r=n(392),c=n(393),d=n(394),u=n(395),h=n(396),l=n(397),p=n(398),g=n(475),f=n(12),m=n(19),y=n(207),v=n(204),b=n(93),P=n(470),I=i.X(o.a,[],function(t){return i._11([i._12(512,i.i,i.S,[[8,[s.a,e.a,r.a,c.a,d.a,u.a,h.a,l.a,p.a,g.a]],[3,i.i],i.s]),i._12(4608,f.l,f.k,[i.r,[2,f.u]]),i._12(4608,m.s,m.s,[]),i._12(4608,m.d,m.d,[]),i._12(512,f.b,f.b,[]),i._12(512,m.q,m.q,[]),i._12(512,m.e,m.e,[]),i._12(512,m.n,m.n,[]),i._12(512,y.a,y.a,[]),i._12(512,y.b,y.b,[]),i._12(512,v.a,v.a,[]),i._12(512,o.a,o.a,[]),i._12(256,b.a,P.a,[])])})},470:function(t,a,n){"use strict";n.d(a,"a",function(){return l});n(1),n(17);var i=n(165),o=n(59),s=n(43),e=n(47),r=(n(22),n(472)),c=n(40),d=(n.n(c),n(389)),u=n(128),h=n(60),l=function(){function t(t,a,n){var c=this;if(this.navParams=t,this.viewCtrl=a,this.engineFactory=n,this.modalPageParams=this.navParams.data,this.modalPage=this.navParams.data.transactionId?"TransactionWizardViewPage":"TransactionWizardAccountStep",this.data=new r.a,this.data.transactionType="Expense",this.data.lines=[],this.data.accountLines=[],this.data.reconciliation=[],this.data.engine=n.getEngineById(t.data.budgetId),null!=t.data.categoryId&&(this.data.engine.getCategory(t.data.categoryId),this.data.category=this.data.engine.db.transactionProcessor.table(o.a).by("id",t.data.categoryId)),t.data.transactionId){this.data.editing=!0;var l=this.data.engine.db.transactionProcessor.table(e.a).by("id",t.data.transactionId);this.data.transaction=this.data.engine.db.transactionProcessor.findTransactionsForRecord(l,i.a)[0],null==this.data.category&&(this.data.category=this.data.engine.db.transactionProcessor.table(o.a).by("id",this.data.transaction.amounts[0].categoryId)),this.data.date=s.a.toIonicFromYYYYMMDD(this.data.transaction.date),this.data.description=this.data.transaction.description,this.data.transaction.amounts.forEach(function(t){c.data.lines.push({categoryId:t.categoryId,amount:t.amount.abs().toString(),negative:t.amount.gt(0)})}),this.data.transaction.accountAmounts&&this.data.transaction.accountAmounts.forEach(function(t){c.data.accountLines.push({accountId:t.accountId,amount:t.amount.abs().toString(),negative:t.amount.gt(0)})}),this.data.engine.db.transactionProcessor.findRecordsForTransaction(this.data.transaction,u.a).forEach(function(t){t.x.reconciliationRecords&&t.x.reconciliationRecords.forEach(function(a){var n=c.data.engine.db.transactionProcessor.table(h.a).by("id",a.bankTransactionId);c.data.reconciliation.push({bankTransaction:n,accountId:t.accountId,amount:a.amount,transaction:c.data.engine.db.transactionProcessor.findTransactionsForRecord(a,d.a)[0]})})}),this.data.transactionType=this.data.total.eq(0)?"Transfer":this.data.total.gt(0)?"Expense":"Money In",this.data.negative="Expense"===this.data.transactionType,this.data.snapshotOriginal()}else this.data.editing=!1,this.data.transactionType=this.navParams.data.transactionType||"Expense",this.data.negative="Expense"===this.data.transactionType,this.data.date=s.a.toIonicFromYYYYMMDD(this.navParams.data.date||s.a.nowYYYYMMDD()),this.data.description=this.navParams.data.description,this.data.lines.push({categoryId:this.data.category?this.data.category.id:void 0,amount:this.navParams.data.amount?this.navParams.data.amount+"":"",negative:this.data.negative})}return t.prototype.done=function(){var t,a=this;(t=this.data.editing?this.data.transaction:new i.a).date=s.a.toYYYYMMDDFromIonic(this.data.date),t.description=this.data.description,t.amounts=[],this.data.lines.forEach(function(a){t.amounts.push({categoryId:a.categoryId,amount:new c.Big((a.amount||"0").replace(",","")).times(a.negative?1:-1)})}),t.accountAmounts=[],this.data.accountLines.forEach(function(a){null!=a.accountId&&null!=a.amount&&"0"!==a.amount.trim()&&a.amount.length>0&&t.accountAmounts.push({accountId:a.accountId,amount:new c.Big((a.amount||"0").replace(",","")).times(a.negative?1:-1)})}),this.data.engine.db.applyTransaction(t),this.data.editing||this.data.reconciliation.forEach(function(n){var i=new d.a,o=a.data.engine.db.transactionProcessor.findRecordsForTransaction(t,u.a);i.accountTransactionId=o.find(function(t){return t.accountId===n.accountId}).id,i.bankTransactionId=n.bankTransaction.id,i.amount=n.amount,a.data.engine.db.applyTransaction(i)}),this.dismiss()},t.prototype.delete=function(){var t=this;this.data.engine.db.deleteTransaction(this.data.transaction),this.data.reconciliation.forEach(function(a){a.transaction&&t.data.engine.db.deleteTransaction(a.transaction)}),this.dismiss()},t.prototype.ngOnInit=function(){},t.prototype.dismiss=function(){this.viewCtrl.dismiss()},t.prototype.next=function(){"TransactionWizardAccountStep"!==this.currentPage.static_name||null!=this.data.description&&0!==this.data.description.trim().length?("TransactionWizardDescriptionStep"===this.currentPage.static_name||"TransactionWizardAccountStep"===this.currentPage.static_name)&&this.data.total.eq(0)&&this.data.lines.length<2?this.navPush("TransactionWizardAmountStep"):this.navPush("TransactionWizardViewPage"):this.navPush("TransactionWizardDescriptionQuickStep")},t.prototype.navPush=function(t){return this.nav.push(t,this.modalPageParams,{animate:!1,keyboardClose:!1})},t.prototype.navRoot=function(t){return this.nav.setRoot(t,this.modalPageParams)},t.prototype.back=function(){this.nav.pop()},t.prototype.canGoBack=function(){return this.nav.canGoBack()},t}()},471:function(t,a,n){"use strict";n.d(a,"a",function(){return i});n(1),n(17);var i=function(){function t(t,a){this.wizard=t,this.platform=a,this.data=t.data}return t.prototype.cancel=function(){this.wizard.dismiss()},t}()},472:function(t,a,n){"use strict";n.d(a,"a",function(){return e});var i=n(40),o=(n.n(i),n(388)),s=n.n(o),e=function(){function t(){}return Object.defineProperty(t.prototype,"total",{get:function(){return this.lines?this.lines.reduce(function(t,a){return t.plus(a.amount?a.amount:0)},new i.Big(0)):new i.Big(0)},enumerable:!0,configurable:!0}),t.prototype.snapshotOriginal=function(){this.originalData=this.stringifyData()},t.prototype.stringifyData=function(){var t={};return t.date=this.date,t.description=this.description,t.lines=this.lines,t.accountLines=this.accountLines,s()(t)},t.prototype.isLocked=function(){return this.editing&&this.reconciliation.length>0},t.prototype.isDirty=function(){return!this.editing||this.originalData!==this.stringifyData()},t}()},473:function(t,a,n){"use strict";n(1),n(0),n(17),n(204),n(470),n(471),n(474),n(472),n(40),n(56),n(205),n(25),n(94),n(3);n.d(a,"a",function(){return i});var i=function(){return function(){}}()},474:function(t,a,n){"use strict";n.d(a,"a",function(){return i});n(1);var i=function(){return function(t){this.wizard=t,this.data=t.data}}()},475:function(t,a,n){"use strict";function i(t){return o._23(0,[o._19(402653184,1,{nav:0}),(t()(),o._0(1,0,null,null,2,"ion-nav",[["id","transactionWizardNav"]],null,null,null,s.b,s.a)),o._18(6144,null,e.a,null,[r.a]),o.Z(3,4374528,[[1,4],["nav",4]],0,r.a,[[2,c.a],[2,d.a],u.a,h.a,l.a,o.j,o.u,o.z,o.i,p.l,g.a,[2,f.a],m.a,o.k],{root:[0,"root"],rootParams:[1,"rootParams"]},null),(t()(),o._21(-1,null,["\n"]))],function(t,a){var n=a.component;t(a,3,0,n.modalPage,n.modalPageParams)},null)}n.d(a,"a",function(){return I});var o=n(0),s=n(206),e=n(67),r=n(92),c=n(5),d=n(18),u=n(7),h=n(2),l=n(4),p=n(11),g=n(66),f=n(36),m=n(8),y=n(470),v=n(16),b=n(22),P=o.Y({encapsulation:2,styles:[],data:{}}),I=o.W("ng-component",y.a,function(t){return o._23(0,[(t()(),o._0(0,0,null,null,1,"ng-component",[],null,null,null,i,P)),o.Z(1,114688,null,0,y.a,[v.a,c.a,b.a],null,null)],function(t,a){t(a,1,0)},null)},{},{},[])}});