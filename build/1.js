webpackJsonp([1],{467:function(t,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),a.d(n,"TransactionWizardViewMenuModuleNgFactory",function(){return T});var i=a(0),o=a(478),e=a(390),s=a(391),r=a(392),c=a(393),u=a(394),d=a(395),l=a(396),h=a(397),f=a(398),m=a(475),p=a(480),g=a(12),v=a(19),y=a(207),_=a(204),b=a(473),P=a(93),I=a(477),T=i.X(o.a,[],function(t){return i._11([i._12(512,i.i,i.S,[[8,[e.a,s.a,r.a,c.a,u.a,d.a,l.a,h.a,f.a,m.a,p.a]],[3,i.i],i.s]),i._12(4608,g.l,g.k,[i.r,[2,g.u]]),i._12(4608,v.s,v.s,[]),i._12(4608,v.d,v.d,[]),i._12(512,g.b,g.b,[]),i._12(512,v.q,v.q,[]),i._12(512,v.e,v.e,[]),i._12(512,v.n,v.n,[]),i._12(512,y.a,y.a,[]),i._12(512,y.b,y.b,[]),i._12(512,_.a,_.a,[]),i._12(512,b.a,b.a,[]),i._12(512,o.a,o.a,[]),i._12(256,P.a,I.a,[])])})},470:function(t,n,a){"use strict";a.d(n,"a",function(){return h});a(1),a(17);var i=a(165),o=a(59),e=a(43),s=a(47),r=(a(22),a(472)),c=a(40),u=(a.n(c),a(389)),d=a(128),l=a(60),h=function(){function t(t,n,a){var c=this;if(this.navParams=t,this.viewCtrl=n,this.engineFactory=a,this.modalPageParams=this.navParams.data,this.modalPage=this.navParams.data.transactionId?"TransactionWizardViewPage":"TransactionWizardAccountStep",this.data=new r.a,this.data.transactionType="Expense",this.data.lines=[],this.data.accountLines=[],this.data.reconciliation=[],this.data.engine=a.getEngineById(t.data.budgetId),null!=t.data.categoryId&&(this.data.engine.getCategory(t.data.categoryId),this.data.category=this.data.engine.db.transactionProcessor.table(o.a).by("id",t.data.categoryId)),t.data.transactionId){this.data.editing=!0;var h=this.data.engine.db.transactionProcessor.table(s.a).by("id",t.data.transactionId);this.data.transaction=this.data.engine.db.transactionProcessor.findTransactionsForRecord(h,i.a)[0],null==this.data.category&&(this.data.category=this.data.engine.db.transactionProcessor.table(o.a).by("id",this.data.transaction.amounts[0].categoryId)),this.data.date=e.a.toIonicFromYYYYMMDD(this.data.transaction.date),this.data.description=this.data.transaction.description,this.data.transaction.amounts.forEach(function(t){c.data.lines.push({categoryId:t.categoryId,amount:t.amount.abs().toString(),negative:t.amount.gt(0)})}),this.data.transaction.accountAmounts&&this.data.transaction.accountAmounts.forEach(function(t){c.data.accountLines.push({accountId:t.accountId,amount:t.amount.abs().toString(),negative:t.amount.gt(0)})}),this.data.engine.db.transactionProcessor.findRecordsForTransaction(this.data.transaction,d.a).forEach(function(t){t.x.reconciliationRecords&&t.x.reconciliationRecords.forEach(function(n){var a=c.data.engine.db.transactionProcessor.table(l.a).by("id",n.bankTransactionId);c.data.reconciliation.push({bankTransaction:a,accountId:t.accountId,amount:n.amount,transaction:c.data.engine.db.transactionProcessor.findTransactionsForRecord(n,u.a)[0]})})}),this.data.transactionType=this.data.total.eq(0)?"Transfer":this.data.total.gt(0)?"Expense":"Money In",this.data.negative="Expense"===this.data.transactionType,this.data.snapshotOriginal()}else this.data.editing=!1,this.data.transactionType=this.navParams.data.transactionType||"Expense",this.data.negative="Expense"===this.data.transactionType,this.data.date=e.a.toIonicFromYYYYMMDD(this.navParams.data.date||e.a.nowYYYYMMDD()),this.data.description=this.navParams.data.description,this.data.lines.push({categoryId:this.data.category?this.data.category.id:void 0,amount:this.navParams.data.amount?this.navParams.data.amount+"":"",negative:this.data.negative})}return t.prototype.done=function(){var t,n=this;(t=this.data.editing?this.data.transaction:new i.a).date=e.a.toYYYYMMDDFromIonic(this.data.date),t.description=this.data.description,t.amounts=[],this.data.lines.forEach(function(n){t.amounts.push({categoryId:n.categoryId,amount:new c.Big((n.amount||"0").replace(",","")).times(n.negative?1:-1)})}),t.accountAmounts=[],this.data.accountLines.forEach(function(n){null!=n.accountId&&null!=n.amount&&"0"!==n.amount.trim()&&n.amount.length>0&&t.accountAmounts.push({accountId:n.accountId,amount:new c.Big((n.amount||"0").replace(",","")).times(n.negative?1:-1)})}),this.data.engine.db.applyTransaction(t),this.data.editing||this.data.reconciliation.forEach(function(a){var i=new u.a,o=n.data.engine.db.transactionProcessor.findRecordsForTransaction(t,d.a);i.accountTransactionId=o.find(function(t){return t.accountId===a.accountId}).id,i.bankTransactionId=a.bankTransaction.id,i.amount=a.amount,n.data.engine.db.applyTransaction(i)}),this.dismiss()},t.prototype.delete=function(){var t=this;this.data.engine.db.deleteTransaction(this.data.transaction),this.data.reconciliation.forEach(function(n){n.transaction&&t.data.engine.db.deleteTransaction(n.transaction)}),this.dismiss()},t.prototype.ngOnInit=function(){},t.prototype.dismiss=function(){this.viewCtrl.dismiss()},t.prototype.next=function(){"TransactionWizardAccountStep"!==this.currentPage.static_name||null!=this.data.description&&0!==this.data.description.trim().length?("TransactionWizardDescriptionStep"===this.currentPage.static_name||"TransactionWizardAccountStep"===this.currentPage.static_name)&&this.data.total.eq(0)&&this.data.lines.length<2?this.navPush("TransactionWizardAmountStep"):this.navPush("TransactionWizardViewPage"):this.navPush("TransactionWizardDescriptionQuickStep")},t.prototype.navPush=function(t){return this.nav.push(t,this.modalPageParams,{animate:!1,keyboardClose:!1})},t.prototype.navRoot=function(t){return this.nav.setRoot(t,this.modalPageParams)},t.prototype.back=function(){this.nav.pop()},t.prototype.canGoBack=function(){return this.nav.canGoBack()},t}()},471:function(t,n,a){"use strict";a.d(n,"a",function(){return i});a(1),a(17);var i=function(){function t(t,n){this.wizard=t,this.platform=n,this.data=t.data}return t.prototype.cancel=function(){this.wizard.dismiss()},t}()},472:function(t,n,a){"use strict";a.d(n,"a",function(){return s});var i=a(40),o=(a.n(i),a(388)),e=a.n(o),s=function(){function t(){}return Object.defineProperty(t.prototype,"total",{get:function(){return this.lines?this.lines.reduce(function(t,n){return t.plus(n.amount?n.amount:0)},new i.Big(0)):new i.Big(0)},enumerable:!0,configurable:!0}),t.prototype.snapshotOriginal=function(){this.originalData=this.stringifyData()},t.prototype.stringifyData=function(){var t={};return t.date=this.date,t.description=this.description,t.lines=this.lines,t.accountLines=this.accountLines,e()(t)},t.prototype.isLocked=function(){return this.editing&&this.reconciliation.length>0},t.prototype.isDirty=function(){return!this.editing||this.originalData!==this.stringifyData()},t}()},473:function(t,n,a){"use strict";a(1),a(0),a(17),a(204),a(470),a(471),a(474),a(472),a(40),a(56),a(205),a(25),a(94),a(3);a.d(n,"a",function(){return i});var i=function(){return function(){}}()},474:function(t,n,a){"use strict";a.d(n,"a",function(){return i});a(1);var i=function(){return function(t){this.wizard=t,this.data=t.data}}()},475:function(t,n,a){"use strict";function i(t){return o._23(0,[o._19(402653184,1,{nav:0}),(t()(),o._0(1,0,null,null,2,"ion-nav",[["id","transactionWizardNav"]],null,null,null,e.b,e.a)),o._18(6144,null,s.a,null,[r.a]),o.Z(3,4374528,[[1,4],["nav",4]],0,r.a,[[2,c.a],[2,u.a],d.a,l.a,h.a,o.j,o.u,o.z,o.i,f.l,m.a,[2,p.a],g.a,o.k],{root:[0,"root"],rootParams:[1,"rootParams"]},null),(t()(),o._21(-1,null,["\n"]))],function(t,n){var a=n.component;t(n,3,0,a.modalPage,a.modalPageParams)},null)}a.d(n,"a",function(){return P});var o=a(0),e=a(206),s=a(67),r=a(92),c=a(5),u=a(18),d=a(7),l=a(2),h=a(4),f=a(11),m=a(66),p=a(36),g=a(8),v=a(470),y=a(16),_=a(22),b=o.Y({encapsulation:2,styles:[],data:{}}),P=o.W("ng-component",v.a,function(t){return o._23(0,[(t()(),o._0(0,0,null,null,1,"ng-component",[],null,null,null,i,b)),o.Z(1,114688,null,0,v.a,[y.a,c.a,_.a],null,null)],function(t,n){t(n,1,0)},null)},{},{},[])},477:function(t,n,a){"use strict";a.d(n,"a",function(){return i});a(1),a(17);var i=function(){function t(t){this.viewCtrl=t,this.wizard=this.viewCtrl.getNavParams().data.wizard}return t.prototype.delete=function(){var t=this;this.viewCtrl.dismiss(void 0,void 0,{animate:!1,duration:0}).then(function(){t.wizard.delete()})},t.prototype.edit=function(){var t=this;this.viewCtrl.dismiss(void 0,void 0,{animate:!1,duration:0}).then(function(){t.wizard.navPush("TransactionWizardDescriptionStep")})},t}()},478:function(t,n,a){"use strict";a.d(n,"a",function(){return i});a(1),a(17),a(204);var i=function(){return function(){}}()},480:function(t,n,a){"use strict";function i(t){return e._23(0,[(t()(),e._0(0,0,null,null,8,"button",[["class","item item-block"],["detail-none",""],["ion-item",""],["no-lines",""]],null,[[null,"click"]],function(t,n,a){var i=!0;if("click"===n){i=!1!==t.component.delete()&&i}return i},s.b,s.a)),e.Z(1,1097728,null,3,r.a,[c.a,u.a,e.j,e.z,[2,d.a]],null,null),e._19(335544320,4,{contentLabel:0}),e._19(603979776,5,{_buttons:1}),e._19(603979776,6,{_icons:1}),e.Z(5,16384,null,0,l.a,[],null,null),(t()(),e._0(6,0,null,0,1,"ion-icon",[["item-start",""],["name","trash"],["role","img"]],[[2,"hide",null]],null,null,null,null)),e.Z(7,147456,[[6,4]],0,h.a,[u.a,e.j,e.z],{name:[0,"name"]},null),(t()(),e._21(-1,2,["Delete"]))],function(t,n){t(n,7,0,"trash")},function(t,n){t(n,6,0,e._14(n,7)._hidden)})}function o(t){return e._23(0,[(t()(),e._21(-1,null,["\n    "])),(t()(),e._0(1,0,null,null,8,"button",[["class","item item-block"],["detail-none",""],["ion-item",""],["no-lines",""]],null,[[null,"click"]],function(t,n,a){var i=!0;if("click"===n){i=!1!==t.component.edit()&&i}return i},s.b,s.a)),e.Z(2,1097728,null,3,r.a,[c.a,u.a,e.j,e.z,[2,d.a]],null,null),e._19(335544320,1,{contentLabel:0}),e._19(603979776,2,{_buttons:1}),e._19(603979776,3,{_icons:1}),e.Z(6,16384,null,0,l.a,[],null,null),(t()(),e._0(7,0,null,0,1,"ion-icon",[["item-start",""],["name","build"],["role","img"]],[[2,"hide",null]],null,null,null,null)),e.Z(8,147456,[[3,4]],0,h.a,[u.a,e.j,e.z],{name:[0,"name"]},null),(t()(),e._21(-1,2,["Edit"])),(t()(),e._21(-1,null,["\n    "])),(t()(),e.V(16777216,null,null,1,null,i)),e.Z(12,16384,null,0,f.j,[e.I,e.F],{ngIf:[0,"ngIf"]},null),(t()(),e._21(-1,null,["\n  "]))],function(t,n){var a=n.component;t(n,8,0,"build");t(n,12,0,a.wizard.data.editing)},function(t,n){t(n,7,0,e._14(n,8)._hidden)})}a.d(n,"a",function(){return v});var e=a(0),s=a(34),r=a(15),c=a(13),u=a(2),d=a(29),l=a(30),h=a(51),f=a(12),m=a(477),p=a(5),g=e.Y({encapsulation:2,styles:[],data:{}}),v=e.W("ng-component",m.a,function(t){return e._23(0,[(t()(),e._0(0,0,null,null,1,"ng-component",[],null,null,null,o,g)),e.Z(1,49152,null,0,m.a,[p.a],null,null)],null,null)},{},{},[])}});