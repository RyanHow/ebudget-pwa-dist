webpackJsonp([5],{465:function(a,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"TransactionWizardModuleNgFactory",function(){return I});var i=n(0),o=n(467),s=n(389),e=n(390),r=n(391),c=n(392),d=n(393),u=n(394),h=n(395),l=n(396),p=n(397),g=n(470),f=n(12),m=n(19),v=n(203),y=n(201),P=n(91),b=n(466),I=i.X(o.a,[],function(a){return i._11([i._12(512,i.i,i.S,[[8,[s.a,e.a,r.a,c.a,d.a,u.a,h.a,l.a,p.a,g.a]],[3,i.i],i.s]),i._12(4608,f.l,f.k,[i.r,[2,f.u]]),i._12(4608,m.s,m.s,[]),i._12(4608,m.d,m.d,[]),i._12(512,f.b,f.b,[]),i._12(512,m.q,m.q,[]),i._12(512,m.e,m.e,[]),i._12(512,m.n,m.n,[]),i._12(512,v.a,v.a,[]),i._12(512,v.b,v.b,[]),i._12(512,y.a,y.a,[]),i._12(512,o.a,o.a,[]),i._12(256,P.a,b.a,[])])})},466:function(a,t,n){"use strict";n(1),n(0),n(17);var i=n(162),o=n(58),s=n(43),e=n(48),r=(n(22),n(40)),c=function(){function a(){}return Object.defineProperty(a.prototype,"total",{get:function(){return this.lines?this.lines.reduce(function(a,t){return a.plus(t.amount?t.amount:0)},new r.Big(0)):new r.Big(0)},enumerable:!0,configurable:!0}),a}(),d=n(388),u=n(163),h=n(67);n.d(t,"a",function(){return l});var l=function(){function a(a,t,n){var r=this;if(this.navParams=a,this.viewCtrl=t,this.engineFactory=n,this.modalPageParams=this.navParams.data,this.modalPage=this.navParams.data.transactionId?"TransactionWizardViewPage":"TransactionWizardStartStep",this.data=new c,this.data.transactionType="Expense",this.data.lines=[],this.data.accountLines=[],this.data.reconciliation=[],this.data.engine=n.getEngineById(a.data.budgetId),null!=a.data.categoryId&&(this.data.engine.getCategory(a.data.categoryId),this.data.category=this.data.engine.db.transactionProcessor.table(o.a).by("id",a.data.categoryId)),a.data.transactionId){this.data.editing=!0;var l=this.data.engine.db.transactionProcessor.table(e.a).by("id",a.data.transactionId);this.data.transaction=this.data.engine.db.transactionProcessor.findTransactionsForRecord(l,i.a)[0],null==this.data.category&&(this.data.category=this.data.engine.db.transactionProcessor.table(o.a).by("id",this.data.transaction.amounts[0].categoryId)),this.data.date=s.a.toIonicFromYYYYMMDD(this.data.transaction.date),this.data.description=this.data.transaction.description,this.data.transaction.amounts.forEach(function(a){r.data.lines.push({categoryId:a.categoryId,amount:a.amount.toString(),negative:a.amount.lt(0)})}),this.data.transaction.accountAmounts.forEach(function(a){r.data.accountLines.push({accountId:a.accountId,amount:a.amount.toString(),negative:a.amount.lt(0)})}),this.data.engine.db.transactionProcessor.findRecordsForTransaction(this.data.transaction,u.a).forEach(function(a){a.x.reconciliationRecords&&a.x.reconciliationRecords.forEach(function(t){var n=r.data.engine.db.transactionProcessor.table(h.a).by("id",t.bankTransactionId);r.data.reconciliation.push({bankTransaction:n,accountId:a.accountId,amount:t.amount,transaction:r.data.engine.db.transactionProcessor.findTransactionsForRecord(t,d.a)[0]})})}),this.data.transactionType=this.data.total.eq(0)?"Transfer":this.data.total.gt(0)?"Expense":"Money In",this.data.negative="Expense"===this.data.transactionType}else this.data.editing=!1,this.data.transactionType=this.navParams.data.transactionType||"Expense",this.data.negative="Expense"===this.data.transactionType,this.data.date=s.a.toIonicFromYYYYMMDD(this.navParams.data.date||s.a.nowYYYYMMDD()),this.data.description=this.navParams.data.description,this.data.lines.push({categoryId:this.data.category?this.data.category.id:void 0,amount:this.navParams.data.amount?this.navParams.data.amount+"":"",negative:this.data.negative})}return a.prototype.done=function(){var a,t=this;(a=this.data.editing?this.data.transaction:new i.a).date=s.a.toYYYYMMDDFromIonic(this.data.date),a.description=this.data.description,a.amounts=[],this.data.lines.forEach(function(t){a.amounts.push({categoryId:t.categoryId,amount:new r.Big((t.amount||"0").replace(",","")).times(t.negative?1:-1)})}),a.accountAmounts=[],this.data.accountLines.forEach(function(t){a.accountAmounts.push({accountId:t.accountId,amount:new r.Big((t.amount||"0").replace(",","")).times(t.negative?1:-1)})}),this.data.engine.db.applyTransaction(a),this.data.editing||this.data.reconciliation.forEach(function(n){var i=new d.a,o=t.data.engine.db.transactionProcessor.findRecordsForTransaction(a,u.a);i.accountTransactionId=o.find(function(a){return a.accountId===n.accountId}).id,i.bankTransactionId=n.bankTransaction.id,i.amount=n.amount,t.data.engine.db.applyTransaction(i)}),this.dismiss()},a.prototype.delete=function(){var a=this;this.data.engine.db.deleteTransaction(this.data.transaction),this.data.reconciliation.forEach(function(t){t.transaction&&a.data.engine.db.deleteTransaction(t.transaction)}),this.dismiss()},a.prototype.ngOnInit=function(){},a.prototype.dismiss=function(){this.viewCtrl.dismiss()},a.prototype.next=function(){"TransactionWizardStartStep"!==this.currentPage.static_name||null!=this.data.description&&0!==this.data.description.trim().length?("TransactionWizardDescriptionStep"===this.currentPage.static_name||"TransactionWizardStartStep"===this.currentPage.static_name)&&this.data.total.eq(0)&&this.data.lines.length<2?this.navPush("TransactionWizardAmountStep"):this.navPush("TransactionWizardViewPage"):this.navPush("TransactionWizardDescriptionStep")},a.prototype.navPush=function(a){return this.nav.push(a,this.modalPageParams,{animate:!1})},a.prototype.navRoot=function(a){return this.nav.setRoot(a,this.modalPageParams)},a.prototype.back=function(){this.nav.pop()},a.prototype.canGoBack=function(){return this.nav.canGoBack()},a}()},467:function(a,t,n){"use strict";n.d(t,"a",function(){return i});n(1),n(17),n(201),n(468),n(469);var i=function(){return function(){}}()},468:function(a,t,n){"use strict";n.d(t,"a",function(){return i});n(1),n(17);var i=function(){function a(a,t){this.wizard=a,this.platform=t,this.data=a.data}return a.prototype.cancel=function(){this.wizard.dismiss()},a}()},469:function(a,t,n){"use strict";n.d(t,"a",function(){return i});n(1);var i=function(){return function(a){this.wizard=a,this.data=a.data}}()},470:function(a,t,n){"use strict";function i(a){return o._23(0,[o._19(402653184,1,{nav:0}),(a()(),o._0(1,0,null,null,2,"ion-nav",[["id","transactionWizardNav"]],null,null,null,s.b,s.a)),o._18(6144,null,e.a,null,[r.a]),o.Z(3,4374528,[[1,4],["nav",4]],0,r.a,[[2,c.a],[2,d.a],u.a,h.a,l.a,o.j,o.u,o.z,o.i,p.l,g.a,[2,f.a],m.a,o.k],{root:[0,"root"],rootParams:[1,"rootParams"]},null),(a()(),o._21(-1,null,["\n"]))],function(a,t){var n=t.component;a(t,3,0,n.modalPage,n.modalPageParams)},null)}n.d(t,"a",function(){return I});var o=n(0),s=n(202),e=n(66),r=n(90),c=n(5),d=n(18),u=n(7),h=n(2),l=n(4),p=n(11),g=n(65),f=n(36),m=n(8),v=n(466),y=n(16),P=n(22),b=o.Y({encapsulation:2,styles:[],data:{}}),I=o.W("ng-component",v.a,function(a){return o._23(0,[(a()(),o._0(0,0,null,null,1,"ng-component",[],null,null,null,i,b)),o.Z(1,114688,null,0,v.a,[y.a,c.a,P.a],null,null)],function(a,t){a(t,1,0)},null)},{},{},[])}});