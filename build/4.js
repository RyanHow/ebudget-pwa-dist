webpackJsonp([4],{464:function(n,t,a){"use strict";function l(n){return u._23(0,[(n()(),u._0(0,0,null,null,5,"button",[["class","account-select-button"],["icon-start",""],["ion-button",""],["no-click-focus",""],["small",""]],[[8,"disabled",0]],[[null,"click"],[null,"mousedown"]],function(n,t,a){var l=!0,i=n.component;if("mousedown"===t){l=!1!==u._14(n,2).onMouseDown(a)&&l}if("click"===t){l=!1!==u._14(n,2).onClick()&&l}if("click"===t){l=!1!==i.selectAccount(n.context.$implicit.id)&&l}return l},P.b,P.a)),u.Z(1,1097728,[[5,4]],0,z.a,[[8,""],I.a,u.j,u.z],{small:[0,"small"],outline:[1,"outline"]},null),u.Z(2,4210688,null,0,Z.a,[u.j,k.a],null,null),(n()(),u._0(3,0,null,0,1,"ion-icon",[["name","card"],["role","img"]],[[2,"hide",null]],null,null,null,null)),u.Z(4,147456,null,0,w.a,[I.a,u.j,u.z],{name:[0,"name"]},null),(n()(),u._21(5,0,["",""]))],function(n,t){var a=t.component;n(t,1,0,"",0===a.data.accountLines.length||t.context.$implicit.id!==a.data.accountLines[0].accountId);n(t,4,0,"card")},function(n,t){n(t,0,0,t.component.data.reconciliation.length>0);n(t,3,0,u._14(t,4)._hidden);n(t,5,0,t.context.$implicit.name)})}function i(n){return u._23(0,[(n()(),u._0(0,0,null,null,8,"ion-header",[["class","transaction-wizard-header"]],null,null,null,null,null)),u.Z(1,16384,null,0,T.a,[I.a,u.j,u.z,[2,j.a]],null,null),(n()(),u._21(-1,null,["\n    "])),(n()(),u._0(3,0,null,null,1,"ion-toolbar",[["class","custom-header-spacer toolbar"]],[[2,"statusbar-padding",null]],null,null,C.b,C.a)),u.Z(4,49152,null,0,D.a,[I.a,u.j,u.z],null,null),(n()(),u._21(-1,null,["\n    "])),(n()(),u._0(6,0,null,null,1,"transaction-wizard-step-header",[],null,null,null,Y.b,Y.a)),u.Z(7,49152,null,0,L.a,[o.a,k.a],{form:[0,"form"]},null),(n()(),u._21(-1,null,["\n"])),(n()(),u._21(-1,null,["\n\n"])),(n()(),u._0(10,0,null,null,44,"ion-content",[["class","transaction-wizard-amount-step"]],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,x.b,x.a)),u.Z(11,4374528,null,0,E.a,[I.a,k.a,M.a,u.j,u.z,W.a,A.a,u.u,[2,j.a],[2,F.a]],null,null),(n()(),u._21(-1,1,["\n    "])),(n()(),u._0(13,0,null,1,40,"div",[["responsive-padding",""]],null,null,null,null,null)),(n()(),u._21(-1,null,["\n        "])),(n()(),u._0(15,0,null,null,26,"form",[["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"submit"],[null,"reset"]],function(n,t,a){var l=!0,i=n.component;if("submit"===t){l=!1!==u._14(n,17).onSubmit(a)&&l}if("reset"===t){l=!1!==u._14(n,17).onReset()&&l}if("submit"===t){a.preventDefault();l=!1!==i.wizard.next()&&l}return l},null,null)),u.Z(16,16384,null,0,S.r,[],null,null),u.Z(17,4210688,[["form",4]],0,S.k,[[8,null],[8,null]],null,null),u._18(2048,null,S.b,null,[S.k]),u.Z(19,16384,null,0,S.j,[S.b],null,null),(n()(),u._21(-1,null,["\n            "])),(n()(),u._0(21,0,null,null,19,"ion-item",[["class","item item-block"]],null,null,null,R.b,R.a)),u.Z(22,1097728,null,3,q.a,[B.a,I.a,u.j,u.z,[2,V.a]],null,null),u._19(335544320,1,{contentLabel:0}),u._19(603979776,2,{_buttons:1}),u._19(603979776,3,{_icons:1}),u.Z(26,16384,null,0,O.a,[],null,null),(n()(),u._21(-1,2,["\n                "])),(n()(),u._0(28,0,null,0,2,"ion-icon",[["item-start",""],["role","img"]],[[2,"hide",null]],null,null,null,null)),u.Z(29,147456,[[3,4]],0,w.a,[I.a,u.j,u.z],null,null),(n()(),u._21(-1,null,["$"])),(n()(),u._21(-1,2,["\n                "])),(n()(),u._0(32,0,null,3,7,"ion-input",[["currency-field",""],["name","amount"],["required",""]],[[1,"autofocus",0],[1,"required",0],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"]],function(n,t,a){var l=!0,i=n.component;if("input"===t){l=!1!==u._14(n,39).onInput()&&l}if("ngModelChange"===t){l=!1!==(i.data.lines[0].amount=a)&&l}return l},$.b,$.a)),u.Z(33,16384,null,0,S.o,[],{required:[0,"required"]},null),u._18(1024,null,S.f,function(n){return[n]},[S.o]),u.Z(35,671744,null,0,S.l,[[2,S.b],[2,S.f],[8,null],[8,null]],{name:[0,"name"],model:[1,"model"]},{update:"ngModelChange"}),u._18(2048,null,S.h,null,[S.l]),u.Z(37,16384,null,0,S.i,[S.h],null,null),u.Z(38,5423104,null,0,G.a,[I.a,k.a,B.a,W.a,u.j,u.z,[2,E.a],[2,q.a],[2,S.h],M.a],null,{input:"input"}),u.Z(39,4210688,null,0,N.a,[u.j,S.h,k.a,U.a],null,null),(n()(),u._21(-1,2,["\n            "])),(n()(),u._21(-1,null,["\n        "])),(n()(),u._21(-1,null,["\n        "])),(n()(),u._0(43,0,null,null,9,"ion-item",[["class","item item-block"],["no-lines",""]],null,null,null,R.b,R.a)),u.Z(44,1097728,null,3,q.a,[B.a,I.a,u.j,u.z,[2,V.a]],null,null),u._19(335544320,4,{contentLabel:0}),u._19(603979776,5,{_buttons:1}),u._19(603979776,6,{_icons:1}),u.Z(48,16384,null,0,O.a,[],null,null),(n()(),u._21(-1,2,["            \n            "])),(n()(),u.V(16777216,null,2,1,null,l)),u.Z(51,802816,null,0,J.i,[u.I,u.F,u.p],{ngForOf:[0,"ngForOf"]},null),(n()(),u._21(-1,2,["\n        "])),(n()(),u._21(-1,null,["\n    "])),(n()(),u._21(-1,1,["\n"]))],function(n,t){var a=t.component;n(t,7,0,u._14(t,17));n(t,33,0,"");n(t,35,0,"amount",a.data.lines[0].amount);n(t,51,0,a.accounts)},function(n,t){n(t,3,0,u._14(t,4)._sbPadding);n(t,10,0,u._14(t,11).statusbarPadding,u._14(t,11)._hasRefresher);n(t,15,0,u._14(t,19).ngClassUntouched,u._14(t,19).ngClassTouched,u._14(t,19).ngClassPristine,u._14(t,19).ngClassDirty,u._14(t,19).ngClassValid,u._14(t,19).ngClassInvalid,u._14(t,19).ngClassPending);n(t,28,0,u._14(t,29)._hidden);n(t,32,0,!0,u._14(t,33).required?"":null,u._14(t,37).ngClassUntouched,u._14(t,37).ngClassTouched,u._14(t,37).ngClassPristine,u._14(t,37).ngClassDirty,u._14(t,37).ngClassValid,u._14(t,37).ngClassInvalid,u._14(t,37).ngClassPending)})}Object.defineProperty(t,"__esModule",{value:!0});var u=a(0),o=(a(1),a(17),a(470)),e=function(){function n(n,t){this.wizard=n,this.elementRef=t,this.static_name="TransactionWizardAmountStep",this.data=this.wizard.data,this.accounts=this.data.engine.getAccounts()}return n.prototype.ionViewDidEnter=function(){this.wizard.currentPage=this},n.prototype.selectAccount=function(n){0===this.data.accountLines.length?this.data.accountLines.push({accountId:n,amount:"0",negative:this.data.negative}):this.data.accountLines[0].accountId=this.data.accountLines[0].accountId===n?null:n},n.prototype.ionViewWillLeave=function(){this.data.accountLines.length>0&&(this.data.accountLines[0].amount=this.data.lines[0].amount)},n}(),s=a(204),c=a(473),r=function(){return function(){}}(),d=a(390),h=a(391),g=a(392),_=a(393),m=a(394),p=a(395),f=a(396),b=a(397),v=a(398),y=a(475),P=a(20),z=a(14),I=a(2),Z=a(399),k=a(4),w=a(51),T=a(31),j=a(5),C=a(52),D=a(27),Y=a(476),L=a(471),x=a(33),E=a(21),M=a(8),W=a(7),A=a(23),F=a(18),S=a(19),R=a(34),q=a(15),B=a(13),V=a(29),O=a(30),$=a(53),G=a(45),N=a(62),U=a(9),J=a(12),Q=u.Y({encapsulation:2,styles:[],data:{}}),X=u.W("ng-component",e,function(n){return u._23(0,[(n()(),u._0(0,0,null,null,1,"ng-component",[],null,null,null,i,Q)),u.Z(1,49152,null,0,e,[o.a,u.j],null,null)],null,null)},{},{},[]),H=a(207),K=a(93);a.d(t,"TransactionWizardAmountStepModuleNgFactory",function(){return nn});var nn=u.X(r,[],function(n){return u._11([u._12(512,u.i,u.S,[[8,[d.a,h.a,g.a,_.a,m.a,p.a,f.a,b.a,v.a,y.a,X]],[3,u.i],u.s]),u._12(4608,J.l,J.k,[u.r,[2,J.u]]),u._12(4608,S.s,S.s,[]),u._12(4608,S.d,S.d,[]),u._12(512,J.b,J.b,[]),u._12(512,S.q,S.q,[]),u._12(512,S.e,S.e,[]),u._12(512,S.n,S.n,[]),u._12(512,H.a,H.a,[]),u._12(512,H.b,H.b,[]),u._12(512,s.a,s.a,[]),u._12(512,c.a,c.a,[]),u._12(512,r,r,[]),u._12(256,K.a,e,[])])})},470:function(n,t,a){"use strict";a.d(t,"a",function(){return h});a(1),a(17);var l=a(165),i=a(59),u=a(43),o=a(47),e=(a(22),a(472)),s=a(40),c=(a.n(s),a(389)),r=a(128),d=a(60),h=function(){function n(n,t,a){var s=this;if(this.navParams=n,this.viewCtrl=t,this.engineFactory=a,this.modalPageParams=this.navParams.data,this.modalPage=this.navParams.data.transactionId?"TransactionWizardViewPage":"TransactionWizardAccountStep",this.data=new e.a,this.data.transactionType="Expense",this.data.lines=[],this.data.accountLines=[],this.data.reconciliation=[],this.data.engine=a.getEngineById(n.data.budgetId),null!=n.data.categoryId&&(this.data.engine.getCategory(n.data.categoryId),this.data.category=this.data.engine.db.transactionProcessor.table(i.a).by("id",n.data.categoryId)),n.data.transactionId){this.data.editing=!0;var h=this.data.engine.db.transactionProcessor.table(o.a).by("id",n.data.transactionId);this.data.transaction=this.data.engine.db.transactionProcessor.findTransactionsForRecord(h,l.a)[0],null==this.data.category&&(this.data.category=this.data.engine.db.transactionProcessor.table(i.a).by("id",this.data.transaction.amounts[0].categoryId)),this.data.date=u.a.toIonicFromYYYYMMDD(this.data.transaction.date),this.data.description=this.data.transaction.description,this.data.transaction.amounts.forEach(function(n){s.data.lines.push({categoryId:n.categoryId,amount:n.amount.abs().toString(),negative:n.amount.gt(0)})}),this.data.transaction.accountAmounts&&this.data.transaction.accountAmounts.forEach(function(n){s.data.accountLines.push({accountId:n.accountId,amount:n.amount.abs().toString(),negative:n.amount.gt(0)})}),this.data.engine.db.transactionProcessor.findRecordsForTransaction(this.data.transaction,r.a).forEach(function(n){n.x.reconciliationRecords&&n.x.reconciliationRecords.forEach(function(t){var a=s.data.engine.db.transactionProcessor.table(d.a).by("id",t.bankTransactionId);s.data.reconciliation.push({bankTransaction:a,accountId:n.accountId,amount:t.amount,transaction:s.data.engine.db.transactionProcessor.findTransactionsForRecord(t,c.a)[0]})})}),this.data.transactionType=this.data.total.eq(0)?"Transfer":this.data.total.gt(0)?"Expense":"Money In",this.data.negative="Expense"===this.data.transactionType,this.data.snapshotOriginal()}else this.data.editing=!1,this.data.transactionType=this.navParams.data.transactionType||"Expense",this.data.negative="Expense"===this.data.transactionType,this.data.date=u.a.toIonicFromYYYYMMDD(this.navParams.data.date||u.a.nowYYYYMMDD()),this.data.description=this.navParams.data.description,this.data.lines.push({categoryId:this.data.category?this.data.category.id:void 0,amount:this.navParams.data.amount?this.navParams.data.amount+"":"",negative:this.data.negative})}return n.prototype.done=function(){var n,t=this;(n=this.data.editing?this.data.transaction:new l.a).date=u.a.toYYYYMMDDFromIonic(this.data.date),n.description=this.data.description,n.amounts=[],this.data.lines.forEach(function(t){n.amounts.push({categoryId:t.categoryId,amount:new s.Big((t.amount||"0").replace(",","")).times(t.negative?1:-1)})}),n.accountAmounts=[],this.data.accountLines.forEach(function(t){null!=t.accountId&&null!=t.amount&&"0"!==t.amount.trim()&&t.amount.length>0&&n.accountAmounts.push({accountId:t.accountId,amount:new s.Big((t.amount||"0").replace(",","")).times(t.negative?1:-1)})}),this.data.engine.db.applyTransaction(n),this.data.editing||this.data.reconciliation.forEach(function(a){var l=new c.a,i=t.data.engine.db.transactionProcessor.findRecordsForTransaction(n,r.a);l.accountTransactionId=i.find(function(n){return n.accountId===a.accountId}).id,l.bankTransactionId=a.bankTransaction.id,l.amount=a.amount,t.data.engine.db.applyTransaction(l)}),this.dismiss()},n.prototype.delete=function(){var n=this;this.data.engine.db.deleteTransaction(this.data.transaction),this.data.reconciliation.forEach(function(t){t.transaction&&n.data.engine.db.deleteTransaction(t.transaction)}),this.dismiss()},n.prototype.ngOnInit=function(){},n.prototype.dismiss=function(){this.viewCtrl.dismiss()},n.prototype.next=function(){"TransactionWizardAccountStep"!==this.currentPage.static_name||null!=this.data.description&&0!==this.data.description.trim().length?("TransactionWizardDescriptionStep"===this.currentPage.static_name||"TransactionWizardAccountStep"===this.currentPage.static_name)&&this.data.total.eq(0)&&this.data.lines.length<2?this.navPush("TransactionWizardAmountStep"):this.navPush("TransactionWizardViewPage"):this.navPush("TransactionWizardDescriptionQuickStep")},n.prototype.navPush=function(n){return this.nav.push(n,this.modalPageParams,{animate:!1,keyboardClose:!1})},n.prototype.navRoot=function(n){return this.nav.setRoot(n,this.modalPageParams)},n.prototype.back=function(){this.nav.pop()},n.prototype.canGoBack=function(){return this.nav.canGoBack()},n}()},471:function(n,t,a){"use strict";a.d(t,"a",function(){return l});a(1),a(17);var l=function(){function n(n,t){this.wizard=n,this.platform=t,this.data=n.data}return n.prototype.cancel=function(){this.wizard.dismiss()},n}()},472:function(n,t,a){"use strict";a.d(t,"a",function(){return o});var l=a(40),i=(a.n(l),a(388)),u=a.n(i),o=function(){function n(){}return Object.defineProperty(n.prototype,"total",{get:function(){return this.lines?this.lines.reduce(function(n,t){return n.plus(t.amount?t.amount:0)},new l.Big(0)):new l.Big(0)},enumerable:!0,configurable:!0}),n.prototype.snapshotOriginal=function(){this.originalData=this.stringifyData()},n.prototype.stringifyData=function(){var n={};return n.date=this.date,n.description=this.description,n.lines=this.lines,n.accountLines=this.accountLines,u()(n)},n.prototype.isLocked=function(){return this.editing&&this.reconciliation.length>0},n.prototype.isDirty=function(){return!this.editing||this.originalData!==this.stringifyData()},n}()},473:function(n,t,a){"use strict";a(1),a(0),a(17),a(204),a(470),a(471),a(474),a(472),a(40),a(56),a(205),a(25),a(94),a(3);a.d(t,"a",function(){return l});var l=function(){return function(){}}()},474:function(n,t,a){"use strict";a.d(t,"a",function(){return l});a(1);var l=function(){return function(n){this.wizard=n,this.data=n.data}}()},475:function(n,t,a){"use strict";function l(n){return i._23(0,[i._19(402653184,1,{nav:0}),(n()(),i._0(1,0,null,null,2,"ion-nav",[["id","transactionWizardNav"]],null,null,null,u.b,u.a)),i._18(6144,null,o.a,null,[e.a]),i.Z(3,4374528,[[1,4],["nav",4]],0,e.a,[[2,s.a],[2,c.a],r.a,d.a,h.a,i.j,i.u,i.z,i.i,g.l,_.a,[2,m.a],p.a,i.k],{root:[0,"root"],rootParams:[1,"rootParams"]},null),(n()(),i._21(-1,null,["\n"]))],function(n,t){var a=t.component;n(t,3,0,a.modalPage,a.modalPageParams)},null)}a.d(t,"a",function(){return P});var i=a(0),u=a(206),o=a(67),e=a(92),s=a(5),c=a(18),r=a(7),d=a(2),h=a(4),g=a(11),_=a(66),m=a(36),p=a(8),f=a(470),b=a(16),v=a(22),y=i.Y({encapsulation:2,styles:[],data:{}}),P=i.W("ng-component",f.a,function(n){return i._23(0,[(n()(),i._0(0,0,null,null,1,"ng-component",[],null,null,null,l,y)),i.Z(1,114688,null,0,f.a,[b.a,s.a,v.a],null,null)],function(n,t){n(t,1,0)},null)},{},{},[])},476:function(n,t,a){"use strict";function l(n){return u._23(0,[(n()(),u._0(0,0,null,null,2,"button",[["ion-button",""]],null,[[null,"click"]],function(n,t,a){var l=!0;if("click"===t){l=!1!==n.component.wizard.back()&&l}return l},o.b,o.a)),u.Z(1,1097728,[[2,4]],0,e.a,[[8,""],s.a,u.j,u.z],null,null),(n()(),u._21(-1,0,["Back"]))],null,null)}function i(n){return u._23(0,[(n()(),u._0(0,0,null,null,32,"ion-toolbar",[["class","toolbar"]],[[2,"statusbar-padding",null]],null,null,c.b,c.a)),u.Z(1,49152,null,0,r.a,[s.a,u.j,u.z],null,null),(n()(),u._21(-1,3,["\n    "])),(n()(),u._0(3,0,null,0,12,"ion-buttons",[["left",""]],null,null,null,null,null)),u.Z(4,16384,null,1,d.a,[s.a,u.j,u.z,[2,r.a],[2,h.a]],null,null),u._19(603979776,1,{_buttons:1}),(n()(),u._21(-1,null,["        \n        "])),(n()(),u._0(7,0,null,null,3,"button",[["class","md-only"],["icon-only",""],["ion-button",""]],null,[[null,"click"]],function(n,t,a){var l=!0;if("click"===t){l=!1!==n.component.wizard.dismiss()&&l}return l},o.b,o.a)),u.Z(8,1097728,[[1,4]],0,e.a,[[8,""],s.a,u.j,u.z],null,null),(n()(),u._0(9,0,null,0,1,"ion-icon",[["name","close"],["role","img"]],[[2,"hide",null]],null,null,null,null)),u.Z(10,147456,null,0,g.a,[s.a,u.j,u.z],{name:[0,"name"]},null),(n()(),u._21(-1,null,["\n        "])),(n()(),u._0(12,0,null,null,2,"button",[["class","ios-only"],["icon-only",""],["ion-button",""]],null,[[null,"click"]],function(n,t,a){var l=!0;if("click"===t){l=!1!==n.component.wizard.dismiss()&&l}return l},o.b,o.a)),u.Z(13,1097728,[[1,4]],0,e.a,[[8,""],s.a,u.j,u.z],null,null),(n()(),u._21(-1,0,["Cancel"])),(n()(),u._21(-1,null,["\n    "])),(n()(),u._21(-1,3,["\n\n    "])),(n()(),u._0(17,0,null,3,2,"ion-title",[],null,null,null,_.b,_.a)),u.Z(18,49152,null,0,m.a,[s.a,u.j,u.z,[2,r.a],[2,h.a]],null,null),(n()(),u._21(19,0,["\n        ","     \n    "])),(n()(),u._21(-1,3,["\n\n    "])),(n()(),u._0(21,0,null,2,10,"ion-buttons",[["end",""]],null,null,null,null,null)),u.Z(22,16384,null,1,d.a,[s.a,u.j,u.z,[2,r.a],[2,h.a]],null,null),u._19(603979776,2,{_buttons:1}),(n()(),u._21(-1,null,["\n        "])),(n()(),u.V(16777216,null,null,1,null,l)),u.Z(26,16384,null,0,p.j,[u.I,u.F],{ngIf:[0,"ngIf"]},null),(n()(),u._21(-1,null,["\n        "])),(n()(),u._0(28,0,null,null,2,"button",[["ion-button",""]],[[8,"disabled",0]],[[null,"click"]],function(n,t,a){var l=!0;if("click"===t){l=!1!==n.component.wizard.next()&&l}return l},o.b,o.a)),u.Z(29,1097728,[[2,4]],0,e.a,[[8,""],s.a,u.j,u.z],null,null),(n()(),u._21(-1,0,["Next"])),(n()(),u._21(-1,null,["\n    "])),(n()(),u._21(-1,3,["\n\n"])),(n()(),u._21(-1,null,["\n\n"])),(n()(),u._0(34,0,null,null,5,"ion-toolbar",[["class","extended-toolbar toolbar"]],[[2,"statusbar-padding",null]],null,null,c.b,c.a)),u.Z(35,49152,null,0,r.a,[s.a,u.j,u.z],null,null),(n()(),u._21(-1,3,["\n    "])),(n()(),u._0(37,0,null,3,1,"div",[["class","toolbar-category-label"]],null,null,null,null,null)),(n()(),u._21(38,null,["\n        in ","\n    "])),(n()(),u._21(-1,3,["\n"])),(n()(),u._21(-1,null,["\n"]))],function(n,t){var a=t.component;n(t,10,0,"close");n(t,26,0,a.wizard.canGoBack())},function(n,t){var a=t.component;n(t,0,0,u._14(t,1)._sbPadding);n(t,9,0,u._14(t,10)._hidden);n(t,19,0,a.data.transactionType);n(t,28,0,a.form&&!a.form.valid);n(t,34,0,u._14(t,35)._sbPadding);n(t,38,0,null==a.data.category?null:a.data.category.name)})}a.d(t,"a",function(){return f}),t.b=i;var u=a(0),o=a(20),e=a(14),s=a(2),c=a(52),r=a(27),d=a(35),h=a(28),g=a(51),_=a(37),m=a(32),p=a(12),f=u.Y({encapsulation:2,styles:[],data:{}})}});